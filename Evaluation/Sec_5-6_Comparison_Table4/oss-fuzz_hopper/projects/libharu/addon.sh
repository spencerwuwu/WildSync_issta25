
new_fuzzers="libharu__HPDF_Annotation_Validate__0 libharu__HPDF_Destination_Validate__0 libharu__HPDF_Destination_Validate__1 libharu__HPDF_Destination_Validate__10 libharu__HPDF_Destination_Validate__2 libharu__HPDF_Destination_Validate__3 libharu__HPDF_Destination_Validate__4 libharu__HPDF_Destination_Validate__5 libharu__HPDF_Destination_Validate__6 libharu__HPDF_Destination_Validate__7 libharu__HPDF_Destination_Validate__8 libharu__HPDF_Destination_Validate__9 libharu__HPDF_Doc_FindEncoder__0 libharu__HPDF_Doc_FindEncoder__1 libharu__HPDF_Doc_FindFontDef__0 libharu__HPDF_Doc_FindFontDef__1 libharu__HPDF_Doc_PrepareEncryption__0 libharu__HPDF_Doc_RegisterEncoder__0 libharu__HPDF_Doc_RegisterEncoder__1 libharu__HPDF_Doc_RegisterEncoder__10 libharu__HPDF_Doc_RegisterEncoder__2 libharu__HPDF_Doc_RegisterEncoder__3 libharu__HPDF_Doc_RegisterEncoder__4 libharu__HPDF_Doc_RegisterEncoder__5 libharu__HPDF_Doc_RegisterEncoder__6 libharu__HPDF_Doc_RegisterEncoder__7 libharu__HPDF_Doc_RegisterEncoder__8 libharu__HPDF_Doc_RegisterEncoder__9 libharu__HPDF_Doc_RegisterFontDef__0 libharu__HPDF_Doc_RegisterFontDef__1 libharu__HPDF_Doc_RegisterFontDef__10 libharu__HPDF_Doc_RegisterFontDef__2 libharu__HPDF_Doc_RegisterFontDef__3 libharu__HPDF_Doc_RegisterFontDef__4 libharu__HPDF_Doc_RegisterFontDef__5 libharu__HPDF_Doc_RegisterFontDef__6 libharu__HPDF_Doc_RegisterFontDef__7 libharu__HPDF_Doc_RegisterFontDef__8 libharu__HPDF_Doc_RegisterFontDef__9 libharu__HPDF_Doc_Validate__0 libharu__HPDF_Doc_Validate__1 libharu__HPDF_Doc_Validate__10 libharu__HPDF_Doc_Validate__2 libharu__HPDF_Doc_Validate__3 libharu__HPDF_Doc_Validate__4 libharu__HPDF_Doc_Validate__5 libharu__HPDF_Doc_Validate__6 libharu__HPDF_Doc_Validate__7 libharu__HPDF_Doc_Validate__8 libharu__HPDF_Doc_Validate__9 libharu__HPDF_Font_MeasureText__0 libharu__HPDF_Font_Validate__0 libharu__HPDF_Font_Validate__1 libharu__HPDF_Font_Validate__2 libharu__HPDF_Font_Validate__3 libharu__HPDF_Font_Validate__4 libharu__HPDF_Font_Validate__5 libharu__HPDF_Font_Validate__6 libharu__HPDF_Font_Validate__7 libharu__HPDF_Font_Validate__8 libharu__HPDF_Font_Validate__9 libharu__HPDF_GetEncoder__0 libharu__HPDF_GetFontDef__0 libharu__HPDF_GetFontDef__1 libharu__HPDF_Image_GetBitsPerComponent__0 libharu__HPDF_Image_GetBitsPerComponent__1 libharu__HPDF_Image_GetColorSpace__0 libharu__HPDF_Image_GetColorSpace__1 libharu__HPDF_Image_Validate__0 libharu__HPDF_Image_Validate__1 libharu__HPDF_Image_Validate__10 libharu__HPDF_Image_Validate__2 libharu__HPDF_Image_Validate__3 libharu__HPDF_Image_Validate__4 libharu__HPDF_Image_Validate__5 libharu__HPDF_Image_Validate__6 libharu__HPDF_Image_Validate__7 libharu__HPDF_Image_Validate__8 libharu__HPDF_Image_Validate__9 libharu__HPDF_NewDoc__0 libharu__HPDF_NewEx__0 libharu__HPDF_Outline_GetFirst__0 libharu__HPDF_Outline_GetNext__0 libharu__HPDF_Outline_GetOpened__0 libharu__HPDF_Outline_GetOpened__1 libharu__HPDF_Outline_Validate__0 libharu__HPDF_Outline_Validate__1 libharu__HPDF_Outline_Validate__2 libharu__HPDF_PDFA_GenerateID__0 libharu__HPDF_PageLabel_New__0 libharu__HPDF_Page_CheckState__0 libharu__HPDF_Page_CheckState__1 libharu__HPDF_Page_CheckState__10 libharu__HPDF_Page_CheckState__2 libharu__HPDF_Page_CheckState__3 libharu__HPDF_Page_CheckState__4 libharu__HPDF_Page_CheckState__5 libharu__HPDF_Page_CheckState__6 libharu__HPDF_Page_CheckState__7 libharu__HPDF_Page_CheckState__8 libharu__HPDF_Page_CheckState__9 libharu__HPDF_Page_ClosePath__0 libharu__HPDF_Page_ClosePath__1 libharu__HPDF_Page_ExecuteXObject__0 libharu__HPDF_Page_Fill__0 libharu__HPDF_Page_Fill__1 libharu__HPDF_Page_GRestore__0 libharu__HPDF_Page_GRestore__1 libharu__HPDF_Page_GetExtGStateName__0 libharu__HPDF_Page_GetInheritableItem__0 libharu__HPDF_Page_GetInheritableItem__1 libharu__HPDF_Page_GetInheritableItem__2 libharu__HPDF_Page_GetInheritableItem__3 libharu__HPDF_Page_GetInheritableItem__4 libharu__HPDF_Page_GetInheritableItem__5 libharu__HPDF_Page_GetInheritableItem__6 libharu__HPDF_Page_GetLocalFontName__0 libharu__HPDF_Page_GetShadingName__0 libharu__HPDF_Page_GetTextRise__0 libharu__HPDF_Page_GetXObjectName__0 libharu__HPDF_Page_InsertBefore__0 libharu__HPDF_Page_New_Content_Stream__0 libharu__HPDF_Page_Stroke__0 libharu__HPDF_Page_Stroke__1 libharu__HPDF_Page_Validate__0 libharu__HPDF_Page_Validate__1 libharu__HPDF_Page_Validate__10 libharu__HPDF_Page_Validate__2 libharu__HPDF_Page_Validate__3 libharu__HPDF_Page_Validate__6 libharu__HPDF_Page_Validate__7 libharu__HPDF_Page_Validate__8 libharu__HPDF_Page_Validate__9 libharu__HPDF_SaveToStream__0 libharu__HPDF_UseUTFEncodings__0"

for new_f in $new_fuzzers; do
    cp "$SRC/new_fuzzers/${new_f}.cpp" "$SRC/new_fuzzers/${new_f}.c"
    f="$SRC/new_fuzzers/${new_f}.c"
    fuzzer_name=$(basename $f .c)
    $CC $BUILD_CFLAGS $LIB_FUZZING_ENGINE \
            ${f} \
            -c -o ${fuzzer_name}.o
    if [ $? -ne 0 ]; then
        echo "Failed to compile $new_f"
        continue
    fi

    $CXX $CXXFLAGS \
            ${fuzzer_name}.o -o $OUT/${fuzzer_name} \
            $PREDEPS_LDFLAGS \
            -L/work/prefix/lib  -lhpdf \
            $BUILD_LDFLAGS \
            $LIB_FUZZING_ENGINE \
            -Wl,-Bdynamic
done

